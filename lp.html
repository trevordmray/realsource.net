<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>LP Dataroom</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-100 text-slate-900" data-page="LP">
  <div class="min-h-screen flex items-center justify-center px-4">
    <div class="w-full max-w-xl bg-white rounded-2xl shadow-lg border border-slate-200 p-6 sm:p-8">
      <header class="mb-6">
        <h1 class="text-xl font-semibold text-slate-900">
          RealSource Properties LP Investor Dataroom
        </h1>
        <p class="mt-1 text-sm text-slate-500">
          Confidential – for LPs and their advisors only.
        </p>
        <p class="mt-1 text-xs text-slate-400">
          Last updated: <span class="font-medium text-slate-500">11/12/2025</span>
        </p>
      </header>

      <!-- Documents -->
      <section class="space-y-3">
        <h2 class="text-sm font-medium text-slate-800">Documents</h2>

        <a href="https://realsource451.sharepoint.com/:b:/g/Eb22tyIEvPtIggnFDWFMUkcBfDqtSosdLm4qqYpAMMdtLw?e=dOxHUi" target="_blank"
           class="block rounded-lg border border-slate-200 px-4 py-3 hover:border-slate-400 hover:bg-slate-50 transition">
          <div class="text-sm font-medium text-slate-900">Notice of Solicitation of Written Consent of Limited Partners</div>
          <div class="mt-0.5 text-xs text-slate-500">Notice and materials relating to the written consent of LPs.</div>
        </a>

        <a href="https://realsource451.sharepoint.com/:b:/g/ESXZyPh392tGgMmyIQQfy3ABFqzcJE0ppJEsjjJ5H11T0Q?e=1z8vIc" target="_blank"
           class="block rounded-lg border border-slate-200 px-4 py-3 hover:border-slate-400 hover:bg-slate-50 transition">
          <div class="text-sm font-medium text-slate-900">Annex A-1 – Agreement and Plan of Merger</div>
          <div class="mt-0.5 text-xs text-slate-500">Definitive merger agreement outlining the terms and structure of the proposed transaction.</div>
        </a>

        <a href="https://realsource451.sharepoint.com/:b:/g/ESHGmcJyoH1DvOlkh9RkqWkBSPwLpAdYn3aosFQIhpfi-A?e=ET4Zxv" target="_blank"
           class="block rounded-lg border border-slate-200 px-4 py-3 hover:border-slate-400 hover:bg-slate-50 transition">
          <div class="text-sm font-medium text-slate-900">Annex B – Internalization Agreement</div>
          <div class="mt-0.5 text-xs text-slate-500">Agreement detailing the internalization of management functions.</div>
        </a>

        <a href="https://realsource451.sharepoint.com/:b:/g/EeTuVPVfV7xFqqvCeGLWIW4BnPaq8xcdWPNL1Htatycaeg?e=LyDqTs" target="_blank"
           class="block rounded-lg border border-slate-200 px-4 py-3 hover:border-slate-400 hover:bg-slate-50 transition">
          <div class="text-sm font-medium text-slate-900">Annex D – CCI Annual Report on Form 10-K (Year Ended Dec 31, 2024)</div>
          <div class="mt-0.5 text-xs text-slate-500">Annual financial statements and disclosures for CCI.</div>
        </a>

        <a href="https://realsource451.sharepoint.com/:b:/g/Ecu6ML_iZuBKjGMVVmK3pqwBaASNipiE3cL_UU5jo-Ix0Q?e=yAunGy" target="_blank"
           class="block rounded-lg border border-slate-200 px-4 py-3 hover:border-slate-400 hover:bg-slate-50 transition">
          <div class="text-sm font-medium text-slate-900">Annex E – CCI Quarterly Report on Form 10-Q (Period Ended June 30, 2025)</div>
          <div class="mt-0.5 text-xs text-slate-500">Quarterly financial report and management analysis for CCI.</div>
        </a>

        <a href="https://realsource451.sharepoint.com/:b:/g/EfH7C1QFI-NNl2mD7mRAyzoBLJBQ7r9WL8xCfVxhX_S-bQ?e=hbKZHn" target="_blank"
           class="block rounded-lg border border-slate-200 px-4 py-3 hover:border-slate-400 hover:bg-slate-50 transition">
          <div class="text-sm font-medium text-slate-900">Annex F – CROP Financial Statements</div>
          <div class="mt-0.5 text-xs text-slate-500">Financial statements for the CROP entity.</div>
        </a>

        <a href="https://realsource451.sharepoint.com/:b:/g/EYUKa4KTDrxLht_Y6arj_jIBAG-vQyI0fgg28l1HE0nrBA?e=76yd2E" target="_blank"
           class="block rounded-lg border border-slate-200 px-4 py-3 hover:border-slate-400 hover:bg-slate-50 transition">
          <div class="text-sm font-medium text-slate-900">Annex I – Management’s Discussion and Analysis of Financial Condition and Results of Operations</div>
          <div class="mt-0.5 text-xs text-slate-500">MD&A for the RS Parties providing financial and operational insights.</div>
        </a>
      </section>

      <footer class="mt-6 border-t border-slate-200 pt-3">
        <p class="text-[11px] text-slate-400">
          This material is confidential and intended solely for the recipient in connection with evaluating
          the proposed transaction. Do not distribute without prior written consent.
        </p>
      </footer>
    </div>
  </div>

  <!-- Visitor Gate -->
  <div id="visit-gate" class="fixed inset-0 z-50 hidden">
    <div class="absolute inset-0 bg-slate-900/70"></div>
    <div class="relative z-10 min-h-screen flex items-center justify-center p-4">
      <div class="w-full max-w-md bg-white rounded-2xl shadow-2xl border border-slate-200 p-6">
        <h2 class="text-lg font-semibold text-slate-900">Identify Yourself</h2>
        <p class="text-sm text-slate-600 mt-1">
          For compliance, please enter your name and acknowledge the following statements to proceed.
        </p>
        <form id="visit-gate-form" class="mt-4 space-y-3">
          <label class="block">
            <span class="text-sm text-slate-700">Full Name</span>
            <input required name="name" type="text" autocomplete="name"
              class="mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-slate-400" />
          </label>

          <div class="space-y-2 text-xs text-slate-600">
            <label class="flex items-start gap-2">
              <input required type="checkbox" class="mt-0.5">
              <span>
                I (LP) acknowledge that, by accessing the consent solicitation statement/PPM and the annexes in this dataroom,
                I have received notice of the solicitation of consents.
              </span>
            </label>

            <label class="flex items-start gap-2">
              <input required type="checkbox" class="mt-0.5">
              <span>
                I (LP) waive any requirements with providing notice in a manner that does not comply with Section 16.1 of the
                Limited Partnership Agreement of RealSource Properties OP, LP, which requires all communications required
                or permitted under the Limited Partnership Agreement to be in writing and deemed to have been given when
                delivered personally or upon deposit in the United States mail, registered, postage prepaid return receipt requested.
              </span>
            </label>
          </div>

          <button id="visit-gate-submit" type="submit"
            class="w-full rounded-lg bg-slate-900 text-white text-sm font-medium py-2.5 hover:bg-slate-800 disabled:opacity-60 flex items-center justify-center gap-2">
            Continue
          </button>
          <p id="visit-gate-error" class="text-xs text-red-600 hidden"></p>
        </form>
        <p class="mt-3 text-[11px] text-slate-500">
          We store only what’s necessary (name, time, page, browser info, and referrer). IP is captured server-side.
        </p>
      </div>
    </div>
  </div>

  <!-- Logger (JSONP + spinner + IP/referrer enhancements) -->
  <script>
  (function () {
    // Update this when you redeploy Apps Script:
    const LOG_ENDPOINT = "https://script.google.com/macros/s/AKfycbwtwtmEYGQMkiDVVrNlqKI3AEJiQuDTxFAGNBkc0cbe1jhgw1MLo_e5QIvSDmDsFZGA5A/exec";

    const page = document.body.getAttribute('data-page') || 'Unknown';
    const STORAGE_KEY = `rs_gate_${page}`;
    const gate = document.getElementById('visit-gate');
    const form = document.getElementById('visit-gate-form');
    const submitBtn = document.getElementById('visit-gate-submit');
    const errEl = document.getElementById('visit-gate-error');

    function showGate() { gate.classList.remove('hidden'); }
    function hideGate() { gate.classList.add('hidden'); }

    try { if (!localStorage.getItem(STORAGE_KEY)) showGate(); } catch (_) { showGate(); }

    // Generic JSONP helper
    function jsonp(url, params, onDone, onError) {
      const cbName = `cb_${Date.now()}_${Math.floor(Math.random() * 1e6)}`;
      window[cbName] = function (resp) {
        try { delete window[cbName]; } catch (_) {}
        if (script && script.parentNode) script.parentNode.removeChild(script);
        onDone(resp);
      };
      const qs = new URLSearchParams({ ...(params || {}), callback: cbName }).toString();
      const script = document.createElement('script');
      script.src = `${url}?${qs}`;
      script.async = true;
      script.onerror = function () {
        try { delete window[cbName]; } catch (_) {}
        if (script && script.parentNode) script.parentNode.removeChild(script);
        onError(new Error('Network/JSONP error'));
      };
      document.head.appendChild(script);
    }

    // Get visitor IP via ipify JSONP (no CORS)
    function getVisitorIP(onDone, onError) {
      jsonp('https://api.ipify.org', { format: 'jsonp' }, function (resp) {
        const ip = (resp && resp.ip) ? resp.ip : '';
        onDone(ip);
      }, onError);
    }

    // Log visit via Apps Script (JSONP)
    function logVisit(params, onDone, onError) {
      jsonp(LOG_ENDPOINT, params, onDone, onError);
    }

    form.addEventListener('submit', function (e) {
      e.preventDefault();
      errEl.classList.add('hidden');

      const name = (new FormData(form).get('name') || '').toString().trim();
      if (!name) {
        errEl.textContent = "Please enter your name.";
        errEl.classList.remove('hidden');
        return;
      }

      // Disable + spinner
      submitBtn.disabled = true;
      const originalHTML = submitBtn.innerHTML;
      submitBtn.innerHTML = `
        <div class="flex items-center justify-center gap-2">
          <div class="h-4 w-4 border-2 border-white border-t-transparent rounded-full animate-spin"></div>
          <span>Logging...</span>
        </div>
      `;

      // Prefer document.referrer, but also send page URL as fallback
      const ref = document.referrer || '';
      const ref_url = window.location.href;

      // 1) Get IP, then 2) Log visit
      getVisitorIP(function (ip) {
        const payload = {
          name,
          page,
          ua: navigator.userAgent || '',
          ref,          // may be empty depending on navigation/policy
          ref_url,      // fallback: current page URL
          ip: ip || ''  // client-sensed IP; server may also provide context.clientIp
        };

        logVisit(payload, function () {
          try { localStorage.setItem(STORAGE_KEY, JSON.stringify({ name, ts: Date.now() })); } catch (_) {}
          hideGate();
          submitBtn.innerHTML = originalHTML;
          submitBtn.disabled = false;
        }, function (err) {
          errEl.textContent = `Could not record your visit. Please try again. (${String(err)})`;
          errEl.classList.remove('hidden');
          submitBtn.innerHTML = originalHTML;
          submitBtn.disabled = false;
        });
      }, function () {
        // If IP service fails, still log without IP
        const payload = { name, page, ua: navigator.userAgent || '', ref, ref_url, ip: '' };
        logVisit(payload, function () {
          try { localStorage.setItem(STORAGE_KEY, JSON.stringify({ name, ts: Date.now() })); } catch (_) {}
          hideGate();
          submitBtn.innerHTML = originalHTML;
          submitBtn.disabled = false;
        }, function (err) {
          errEl.textContent = `Could not record your visit. Please try again. (${String(err)})`;
          errEl.classList.remove('hidden');
          submitBtn.innerHTML = originalHTML;
          submitBtn.disabled = false;
        });
      });
    });
  })();
  </script>
</body>
</html>
